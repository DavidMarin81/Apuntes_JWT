# Para qué sirven las consultas en inicio
## Mapeo entre las consultas y estados de React
| Estado en React | Consulta | Explicación
|---|---|---|
|Dispositivos|totalDevices|Cuenta los dispositivos activos de la empresa (sig_dispositivos)|
|Certificados|totalCertificates|Devuelve el total de certificados activos de la empresa (cli_certificados)|
|RemoteSignature|totalDocumentsActivos / mostrarDocumentos|Consulta documentos o firmas remotas activas para la empresa (one_clientes_paquetes/sig_clientes_paquetes)|
|SMS|TotalAvaible|Consulta los créditos SMS disponibles (one_clientes + lic_client)|
|Paquetes|TotalPurchasedSignature / consultas de paquetes | Devuelve los totales de paquetes Uanataca y Camerfirma para la empresa (sig_clientes_paquetes y one_clientes_paquetes)|
|expira|expireProduct|Comprueba si algún paquete o certificado caduca pronto (<= 30 días)|
|sinProducto|haveProduct|Devuelve booleanos indicando si el usuario tiene licencia, SMS, One, Sig o certificados|
|CamerfirmaNormal, UanatacaLong, Uanataca|ExisteSignature|Totales por tipo de paquete (Camerfirma, Uanataca, Uanataca Long)|
|ExistCertificados|gridCertificates|Para indicar si hay certificados que mostrar|
|ExistDocumentos|mostrarDocumentos|Para indicar si hay documentos remotos que mostrar|

## Observaciones importantes
- Todas las consultas van filtradas por CIF o idOne, por lo que solo cargan datos del usuario que ha iniciado sesión. Esto es correcto para un dashboard personalizado.

- Expiraciones y existencia de productos (expireProduct, haveProduct) se usan para decidir si mostrar la tarjeta como activa o inactiva, y si se muestra la alerta de caducidad.

- Paquetes separados por tipo (Camerfirma, Uanataca, Longeba) se asignan a estados diferentes para que DatosContenedor y ContenedorGrande puedan mostrar la información correctamente.

## Objeto que se tiene que enviar del Backend
- Objeto que viene del backend
    ~~~js
    {
        "empresa": {
            "cif": "A12345678",
            "idEmpresa": 1,
            "empresaIdOne": 42,
            "userName": "usuarioX"
        },

        "productos": {
            "haveLic": true,
            "haveSms": true,
            "haveSig": true,
            "haveRemoteSig": true
        },

        "expiraciones": {
            "one": false,
            "sig": true,
            "cer": false
        },

        "tarjetas": {
            "dispositivos": {
            "total": 12
            },

            "sms": {
            "total": 120
            },

            "paquetesSignature": {
            "totalUanataca": 8,
            "totalCamerfirma": 4
            },

            "paquetesIA": {
            "total": 3,
            "lista": [
                { "id": 1, "codigo": "IA-001", "total": 2 },
                { "id": 2, "codigo": "IA-003", "total": 1 }
            ]
            },

            "paquetesRemoteSignature": {
            "packages": [
                /* Importante: el orden aquí debe respetar lo que espera tu UI actual:
                index 0 = Uanataca - Avanzada
                index 1 = Camerfirma - Reforzada
                index 2 = Camerfirma - Avanzada
                index 3 = Camerfirma - Cualificada
                */
                { "key":"uanataca_avanzada", "label":"Uanataca - Avanzada",   "total": 10, "negativos":0, "activo": true,  "caduca": false },
                { "key":"camerfirma_reforzada","label":"Camerfirma - Reforzada","total": 2,  "negativos":0, "activo": true,  "caduca": false },
                { "key":"camerfirma_avanzada","label":"Camerfirma - Avanzada",  "total": 5,  "negativos":1, "activo": true,  "caduca": true  },
                { "key":"camerfirma_cualificada","label":"Camerfirma - Cualificada","total": 1,"negativos":0, "activo": false, "caduca": false }
            ]
            }
        }
    }
    ~~~

- Por qué así y cómo lo usa Inicio.js
    - tarjetas.dispositivos.total = rellena la tarjeta total dispositivos
    - tarjetas.sms.total = rellena la tarjeta SMS
    - tarjetas.paquetesSignature.* = rellena Paquetes DF-Signature(Uanataca - Camerfirma)
    - tarjetas.paquetesIA.total = rellena Paquetes de IA. lista es opcional si quieres detalles
    - tarjeta.paquetesRemoteSignature.packages = Paquetes DF-Remote Signature, en orden que la UI actual espera los datos. 

- Además
    - productos.* sirve para decidir si cada tarjeta está activa / inactiva
    - expiraciones.* puede usarse para los iconos de expirar globales

## Lo que podría devolver el backend
- Objeto que llega del backend
    ~~~js
    {
        "tarjetas": {
            "dispositivos": { "total": 12 },
            "sms": { "total": 120 },
            "paquetesSignature": {
            "totalUanataca": 8,
            "totalCamerfirma": 4
            },
            "paquetesIA": { "total": 3 },
            "paquetesRemoteSignature": {
            "packages": [
                { "key": "uanataca_avanzada", "label": "Uanataca - Avanzada", "total": 10 },
                { "key": "camerfirma_reforzada", "label": "Camerfirma - Reforzada", "total": 2 },
                { "key": "camerfirma_avanzada", "label": "Camerfirma - Avanzada", "total": 5 },
                { "key": "camerfirma_cualificada", "label": "Camerfirma - Cualificada", "total": 1 }
            ]
            }
        }
    }
    ~~~