# Creación de aplicación completa (Backend y Frontend) con JWT

## Instalaciones
- `Dapper`: micro ORM ligero para mapear resultados de SQL a objetos C#
- `MySql.Data`: driver oficial de MySQL para .NET
    ~~~bash
    dotnet add package Dapper
    dotnet add package MySql.Data
    ~~~

## Configuramos la cadena de conexión
- En `appsettings.json`
    ~~~json
    {
        "ConnectionStrings": {
            "DefaultConnection": "Server=localhost;Database=pruebajwt;User=root;Password=tuPassword;"
        }
    }
    ~~~
- En `Program.cs`
    ~~~csharp
    using MySql.Data.MySqlClient;
    using System.Data;

    builder.Services.AddSingleton<IDbConnection>(sp =>
        new MySqlConnection(builder.Configuration.GetConnectionString("DefaultConnection")));
    ~~~
    - Esto inyecta `IDBConnection` para usarlo en tus controladores

## Crear la tabla Users en MySQL
~~~sql
CREATE TABLE Users (
    Id INT AUTO_INCREMENT PRIMARY KEY,
    Username VARCHAR(50) NOT NULL UNIQUE,
    PasswordHash VARCHAR(255) NOT NULL,
    Role VARCHAR(20) NOT NULL
);
~~~
- `Username` es único
- `Role` puede ser `user` o `admin`

## Preparamos la base de datos y modelos
- Creamos una carpeta `Models` y dentro definimos el usuario
    ~~~C#
    // Models/User.cs
    public class User
    {
        public int Id { get; set; }
        public string Username { get; set; }
        public string PasswordHash { get; set; }
        public string Role { get; set; }
    }
    ~~~
- Creamos un `DTO`para login y registro:
    ~~~C#
    // Models/LoginDTO.cs
    public class LoginDTO
    {
        public string Username { get; set; }
        public string Password { get; set; }
    }

    // Models/RegisterDTO.cs
    public class RegisterDTO
    {
        public string Username { get; set; }
        public string Password { get; set; }
    }
    ~~~

## Crear el Repository
- Carpeta: `Repository`
